general:
  branches:
    ignore:
      - gh-pages

machine:
  environment:
    LISP: sbcl

dependencies:
  pre:
    - curl -L https://raw.githubusercontent.com/snmsts/roswell/release/scripts/install-for-ci.sh | sh;
    - case $CIRCLE_NODE_INDEX in
        0) ros config set default.lisp sbcl-bin ;;
        1) ros install ccl-bin;
           ros config set default.lisp ccl-bin ;;
      esac

  cache_directories:
    - ~/.roswell
    
test:
  override:
    - ros run -- --version
    - ros -s prove
          -e '(or (prove:run :elb-log-test) (uiop:quit -1))': {parallel: true}
